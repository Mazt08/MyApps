<ion-app>
  <!-- Side Menu -->
  <ion-menu menuId="main-menu" contentId="main" [disabled]="isLoginRoute">
    <ion-content>
      <div class="menu-header-bg"></div>

      <div class="header-content">
        <!-- User Profile (only when not guest) -->
        <div class="developer" *ngIf="!isGuest; else guestHeader">
          <ion-avatar class="profile-avatar">
            <img
              [src]="user?.avatarUrl || 'assets/icon/jay.png'"
              (error)="useDefaultAvatar($event)"
              [alt]="user?.name || 'User'"
            />
          </ion-avatar>
          <ion-label>
            <h2>{{ user?.name }}</h2>
            <p class="user-number">{{ user?.phone || user?.email }}</p>
          </ion-label>
          <ion-button
            size="small"
            fill="clear"
            color="light"
            (click)="editProfile()"
          >
            <ion-icon name="create-outline"></ion-icon>
          </ion-button>
        </div>
        <ng-template #guestHeader>
          <div class="developer">
            <ion-icon
              name="person-circle-outline"
              class="guest-avatar"
            ></ion-icon>
            <ion-label>
              <h2>Guest</h2>
              <p class="user-number">Sign in to personalize</p>
            </ion-label>
          </div>
        </ng-template>
      </div>

      <div class="action-button" *ngIf="isGuest">
        <ion-menu-toggle auto-hide="true">
          <ion-button (click)="navigateToLogin()" routerDirection="forward">
            <ion-icon slot="start" name="log-in-outline"></ion-icon>
            Sign In / Register
          </ion-button>
        </ion-menu-toggle>
      </div>

      <ion-list class="menu-items" lines="none">
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/home')"
            [class.active]="isActive('/home')"
          >
            <ion-icon name="home-outline" slot="start"></ion-icon>
            Home
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true" *ngIf="user?.isAdmin && !isGuest">
          <ion-item
            button
            (click)="navigate('/admin')"
            [class.active]="isActive('/admin')"
          >
            <ion-icon name="settings-outline" slot="start"></ion-icon>
            Admin
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/about')"
            [class.active]="isActive('/about')"
          >
            <ion-icon name="information-circle-outline" slot="start"></ion-icon>
            About
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/company-history')"
            [class.active]="isActive('/company-history')"
          >
            <ion-icon name="business-outline" slot="start"></ion-icon>
            Company History
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/contact')"
            [class.active]="isActive('/contact')"
          >
            <ion-icon name="chatbubbles-outline" slot="start"></ion-icon>
            Contact
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/developers')"
            [class.active]="isActive('/developers')"
          >
            <ion-icon name="people-outline" slot="start"></ion-icon>
            Developers
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true" *ngIf="!isGuest">
          <ion-item
            button
            (click)="navigate('/profile-settings')"
            [class.active]="isActive('/profile-settings')"
          >
            <ion-icon name="person-outline" slot="start"></ion-icon>
            Profile Settings
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="handleCart()"
            [class.active]="isActive('/cart')"
          >
            <ion-icon name="cart-outline"></ion-icon>
            Cart
          </ion-item>
        </ion-menu-toggle>

        <ion-menu-toggle auto-hide="true" *ngIf="!isGuest">
          <ion-item button (click)="signOut()">
            <ion-icon name="log-out-outline"></ion-icon>
            Sign out
          </ion-item>
        </ion-menu-toggle>
      </ion-list>
    </ion-content>
  </ion-menu>

  <!-- Admin Management Menu: shown when pages use menu="admin-menu" -->
  <ion-menu
    menuId="admin-menu"
    contentId="main"
    side="start"
    [disabled]="!user?.isAdmin || isLoginRoute"
    [hidden]="!user?.isAdmin"
  >
    <ion-content>
      <ion-list lines="none">
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/admin')"
            [class.active]="isActive('/admin')"
          >
            <ion-icon slot="start" name="speedometer-outline"></ion-icon>
            Dashboard
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/admin/orders')"
            [class.active]="isActive('/admin/orders')"
          >
            <ion-icon slot="start" name="receipt-outline"></ion-icon>
            Orders
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/admin/products')"
            [class.active]="isActive('/admin/products')"
          >
            <ion-icon slot="start" name="pricetags-outline"></ion-icon>
            Products
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/admin/reports')"
            [class.active]="isActive('/admin/reports')"
          >
            <ion-icon slot="start" name="stats-chart-outline"></ion-icon>
            Reports
          </ion-item>
        </ion-menu-toggle>
        <ion-menu-toggle auto-hide="true">
          <ion-item
            button
            (click)="navigate('/admin/users')"
            [class.active]="isActive('/admin/users')"
          >
            <ion-icon slot="start" name="people-outline"></ion-icon>
            Users
          </ion-item>
        </ion-menu-toggle>
      </ion-list>
    </ion-content>
  </ion-menu>

  <!-- Main Content -->
  <ion-router-outlet id="main"></ion-router-outlet>
</ion-app>
